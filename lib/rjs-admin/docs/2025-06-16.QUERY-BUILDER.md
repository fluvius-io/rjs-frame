## Metadata Format

With the metadata below, generate a QueryBuilder component, in the same directory with SPECS.md.

```javascript
QUERY_METADATA = {
  "name": "user",
  "title": "UserQuery",
  "desc": "List all user accounts",
  "fields": {  // Fields metadata, list of fields available for the query
    "id": {
      "label": "User ID",
      "name": "id",   // name / key of the field, same value with the mapping key
      "desc": null,   // field description
      "noop": "eq",   // default query operation when none is specified.
      "hidden": true, // field is not displayed on the datatable by default
      "sortable": true // field is sortable
    },
    "name__given": {
      "label": "Given Name",
      "name": "name__given",
      "desc": null,
      "noop": "eq",
      "hidden": false,
      "sortable": true
    },
    "name__family": {
      "label": "Family Name",
      "name": "name__family",
      "desc": null,
      "noop": "eq",
      "hidden": false,
      "sortable": true
    }
  },
  "filters": {   // Query operators' metadata
    "id.eq": {   // key of the operator, uniquely identify the operator
      "field": "id",  // field that is associated with this operator, this is the first part of the key (dot separated)
      "label": "Equals",  // label for user display
      "dtype": "uuid",  // datatype of the value, use for basic validation
      "input": {   // information to be passed into the FilterInput component to render the input widget.

        "type": "text",
        "placeholder": "Enter some values ..."
      }
    },
    "id.in": {
      "field": "id",
      "label": "In List",
      "dtype": "uuid",
      "input": {
        "type": "text"
      }
    },
    "name__given.eq": {
      "field": "name__given",
      "label": "Equals",
      "dtype": "string",
      "input": {
        "type": "text"
      }
    },
    "name__given.ilike": {
      "field": "name__given",
      "label": "Contains",
      "dtype": "string",
      "input": {
        "type": "text"
      }
    },
    "name__given.ne": {
      "field": "name__given",
      "label": "Not Equals",
      "dtype": "string",
      "input": {
        "type": "text"
      }
    },
    "name__family.eq": {
      "field": "name__family",
      "label": "Equals",
      "dtype": "string",
      "input": {
        "type": "text"
      }
    },
    "name__family.ilike": {
      "field": "name__family",
      "label": "Contains",
      "dtype": "string",
      "input": {
        "type": "text"
      }
    },
    "name__family.ne": {
      "field": "name__family",
      "label": "Not Equals",
      "dtype": "string",
      "input": {
        "type": "text"
      }
    }
  },
  "composites": {  // Composite operators
    ".and": {
        "label": "And"
    },
    ".or": {
        "label": "Or"
    }
  }
  "default_order": ["id.desc"]
}

```

## Input / Output Structure

The component receive and trigger a callback with the same structure (QueryState) which has the following attributes:

QueryState:

- query: List of query statements
- sort: List of sort statements in the format `<field_name>.[asc|desc]`
- select: List of fields to be returned by the query
- search: a string of search text for full-text search or query generation.

Examples:

- Example 1

```javascript
{"query": [{".and": {"name__family": "Potter", "name__given": "Harry"}}]}
```

- Example 2

```javascript
{"query": [{".or": [{"name__family": "Potter"}, {"name__given": "Harry"}]}]}
```

- Example 3

NOTE: `!` in `name__given!eq` separator indicate a negate action.

```javascript
{"query": [{"name__family": "Potter"}, {"name__given!eq": "Harry"}], "sort": ["name__given.asc"], "select": ["name__family",], "search": "phoenix"}
```

## Usage

- [Field Selection] User select fields with checkboxes, each checkbox should have flag and description of the field if any
- [Filter Builder] For the filter query, user select query expressions with a dropdown button that list the fields name and available composite expressions
  - After that, user can select the exact operator and input filter values
- FilterInput component should only accept the operator input mapping as the only parameter besides the value.
- Composite operators receive a list of other query parameters as its value. The operators included in the value list can be also composite operators, but not itself (e.g. and statement's value cannot contain and statement).
- FilterInput params can be overrided by a mapping props passed into the query builder.
  - E.g. `<QueryBuilder customInput={{"id.eq": {"type":"select", "options": ["first", "second"]}}}>` -> Override input params for "ID equals" operator with a select box.

## Other requirements

- Use Radix-UI primitives for filter input and query builder widgets
- Use TailwindCSS for styling
- Use semantic class names for css classes,
- Use PostCSS @apply syntax to manage the styles.
- Locations:
  - PostCSS styles: ./lib/rjs-admin/src/styles/components/
  - Component files: ./lib/rjs-admin/src/components/querybuilder/
  - Types definitions: ./lib/rjs-admin/src/types//querybuilder.ts
  - Storybook stories: ./lib/rjs-admin/stories/

## Component Structure

- QueryBuilder({queryState, metadata, onQueryStateChange})
  - QBTextInput(search: queryState.search)
  - QBFilterEditor({filters: queryState.query, metadata})
  - QBFieldSelector({select: queryState.select, metadata})
  - QBSortEditor({sort: queryState.sort, metadata})
- QueryBuilderModal
