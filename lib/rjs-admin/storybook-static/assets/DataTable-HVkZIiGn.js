import{j as e}from"./jsx-runtime-BjG_zV1W.js";import{M as B,C as U}from"./QueryBuilder-yOD016_Y.js";import{R as G,r as x}from"./iframe-4KYKMOYs.js";import{c as f,B as w}from"./Button-eyc4dcTo.js";import{F as J}from"./FilterModal-DA-8JZVV.js";const A=({metadata:a,sort:d,onSort:o})=>{const i=n=>{var h;const r=(h=a==null?void 0:a.fields)==null?void 0:h[n];if(!(r!=null&&r.sortable)||!o)return;const g=(d==null?void 0:d.field)===n&&d.direction==="asc"?"desc":"asc";o({field:n,direction:g})},m=n=>{var g;const r=(g=a==null?void 0:a.fields)==null?void 0:g[n];return r!=null&&r.sortable?(d==null?void 0:d.field)===n?d.direction==="asc"?"↑":"↓":"↕":null},p=n=>n.identifier?"text-center":"text-left";if(!(a!=null&&a.fields))return e.jsx("thead",{className:"bg-muted/50",children:e.jsx("tr",{className:"border-b",children:e.jsx("th",{className:"px-4 py-3 font-medium text-sm text-muted-foreground",children:"Loading..."})})});const t=Object.entries(a.fields).filter(([,n])=>!n.hidden);return e.jsx("thead",{className:"bg-muted/50",children:e.jsx("tr",{className:"border-b",children:t.map(([n,r])=>e.jsx("th",{className:f("px-4 py-3 font-medium text-sm text-muted-foreground",p(r),r.sortable&&o&&"cursor-pointer hover:text-foreground transition-colors"),onClick:()=>i(n),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:r.label}),r.sortable&&o&&e.jsx("span",{className:"text-xs opacity-60",children:m(n)})]})},n))})})};A.__docgenInfo={description:"",methods:[],displayName:"HeaderComponent",props:{metadata:{required:!0,tsType:{name:"QueryMetadata"},description:""},sort:{required:!1,tsType:{name:"SortConfig"},description:""},onSort:{required:!1,tsType:{name:"signature",type:"function",raw:"(sort: SortConfig) => void",signature:{arguments:[{type:{name:"SortConfig"},name:"sort"}],return:{name:"void"}}},description:""}}};const L=({pagination:a,onPageChange:d,loading:o=!1})=>{const{page:i,pageSize:m,total:p,showSizeChanger:t=!0,pageSizeOptions:n=[10,20,50,100]}=a,r=Math.ceil(p/m),g=(i-1)*m+1,h=Math.min(i*m,p),c=s=>{d&&s>=1&&s<=r&&d(s,m)},C=s=>{if(d){const y=Math.ceil(g/s);d(y,s)}},S=()=>{const s=[];if(r<=7)for(let b=1;b<=r;b++)s.push(b);else{s.push(1),i>4&&s.push("...");const b=Math.max(2,i-2),k=Math.min(r-1,i+2);for(let j=b;j<=k;j++)s.push(j);i<r-3&&s.push("..."),r>1&&s.push(r)}return s};return p===0?e.jsx("div",{className:"flex items-center justify-between px-4 py-3 bg-background",children:e.jsx("div",{className:"text-sm text-muted-foreground",children:"No records found"})}):e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-background",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[t&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Show:"}),e.jsx("select",{value:m,onChange:s=>C(Number(s.target.value)),disabled:o,className:"px-2 py-1 text-sm border rounded bg-background",children:n.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[g," to ",h," of ",p," records"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(w,{variant:"outline",size:"sm",onClick:()=>c(1),disabled:i===1||o,children:"⇤"}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>c(i-1),disabled:i===1||o,children:"←"}),S().map((s,y)=>e.jsx(G.Fragment,{children:s==="..."?e.jsx("span",{className:"px-2 py-1 text-sm text-muted-foreground",children:"..."}):e.jsx(w,{variant:i===s?"default":"outline",size:"sm",onClick:()=>c(s),disabled:o,className:f(i===s&&"bg-primary text-primary-foreground"),children:s})},y)),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>c(i+1),disabled:i===r||o,children:"→"}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>c(r),disabled:i===r||o,children:"⇥"})]})]})};L.__docgenInfo={description:"",methods:[],displayName:"PaginationControls",props:{pagination:{required:!0,tsType:{name:"PaginationConfig"},description:""},onPageChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(page: number, pageSize: number) => void",signature:{arguments:[{type:{name:"number"},name:"page"},{type:{name:"number"},name:"pageSize"}],return:{name:"void"}}},description:""},loading:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}}}};const M=({metadata:a,data:d,index:o})=>{const i=t=>t.identifier?"text-center":"text-left",m=(t,n)=>{if(t==null)return"-";if(typeof t=="boolean")return t?"✓":"✗";if(typeof t=="number")return t.toLocaleString();if(typeof t=="string"&&(n.includes("date")||n.includes("time")))try{const r=new Date(t);if(!isNaN(r.getTime()))return r.toLocaleDateString()}catch{}return String(t)};if(!(a!=null&&a.fields))return e.jsx("tr",{className:f("border-b hover:bg-muted/30 transition-colors",o%2===0?"bg-background":"bg-muted/10"),children:e.jsx("td",{className:"px-4 py-3 text-sm text-muted-foreground",children:"Loading..."})});const p=Object.entries(a.fields).filter(([,t])=>!t.hidden);return e.jsx("tr",{className:f("border-b hover:bg-muted/30 transition-colors",o%2===0?"bg-background":"bg-muted/10"),children:p.map(([t,n])=>e.jsx("td",{className:f("px-4 py-3 text-sm",i(n)),children:m(d[t],t)},t))})};M.__docgenInfo={description:"",methods:[],displayName:"RowComponent",props:{metadata:{required:!0,tsType:{name:"QueryMetadata"},description:""},data:{required:!0,tsType:{name:"Record",elements:[{name:"string"},{name:"any"}],raw:"Record<string, any>"},description:""},index:{required:!0,tsType:{name:"number"},description:""}}};const K=a=>{const{data:d,pagination:o,loading:i=!1,backgroundLoading:m=!1,title:p,subtitle:t,showSearch:n=!1,showFilters:r=!1,searchPlaceholder:g="Search...",onQueryChange:h,onPageChange:c,actions:C,className:S,metadata:s}=a,[y,b]=x.useState(""),[k,j]=x.useState(!1),[Q,R]=x.useState(),[v,F]=x.useState({select:[],sort:[],query:void 0,searchQuery:void 0});x.useEffect(()=>{if(s!=null&&s.default_order&&s.default_order.length>0&&!Q){const l=s.default_order[0],[u,_]=l.split(":");R({field:u,direction:_==="desc"?"desc":"asc"});const H={...v,sort:[`${u}:${_}`]};F(H)}},[s,v]);const N=x.useCallback(l=>{const u={...v,...l};F(u),h==null||h(u)},[v,h]),I=l=>{const u=l.target.value;b(u),N({searchQuery:u||void 0}),c==null||c(1,o.pageSize)},O=l=>{R(l),N({sort:[`${l.field}:${l.direction}`]})},z=x.useCallback(l=>{N({query:l.query}),c==null||c(1,o.pageSize)},[N,o.pageSize,c]),D=x.useCallback(l=>{z(l)},[z]),P=x.useCallback(()=>{j(!1)},[]),V=x.useCallback(()=>{j(!0)},[]),$=x.useCallback((l,u)=>{c==null||c(l,u)},[c]),q=v.query,T=q&&q.length>0;if(!s)return e.jsx("div",{className:f("bg-background border rounded-lg shadow-sm",S),children:e.jsx("div",{className:"p-8 text-center",children:e.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading metadata..."})})});const E=s.operators&&Object.values(s.operators).some(l=>l.field_name!=="");return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:f("bg-background border rounded-lg shadow-sm",S),children:[(p||t||C||n||r)&&e.jsxs("div",{className:"p-4 border-b",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[p&&e.jsx("h2",{className:"text-lg font-semibold",children:p}),t&&e.jsx("p",{className:"text-sm text-muted-foreground",children:t})]}),e.jsx("div",{className:"flex items-center gap-2",children:C})]}),(n||r)&&e.jsxs("div",{className:"flex items-center gap-4",children:[n&&e.jsx("div",{className:"flex-1 max-w-sm",children:e.jsx("input",{type:"text",value:y,onChange:I,placeholder:g,className:"w-full px-3 py-2 text-sm border rounded-md bg-background"})}),r&&E&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:V,className:f("inline-flex items-center gap-2 px-3 py-1 text-sm border rounded font-medium",T?"bg-blue-100 border-blue-300 text-blue-700":"bg-white hover:bg-gray-50"),children:[e.jsx(B,{className:"w-4 h-4"}),"Filters",T&&e.jsx("span",{className:"ml-1 px-1.5 py-0.5 bg-blue-200 text-blue-800 text-xs rounded-full",children:"Active"})]})})]}),T&&e.jsx("div",{className:"mt-3 p-2 bg-blue-50 border border-blue-200 rounded-md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Active Filters:"}),e.jsx("span",{className:"text-sm text-blue-600 font-mono",children:q})]}),e.jsx("button",{onClick:()=>N({query:void 0}),className:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded",title:"Clear all filters",children:e.jsx(U,{className:"w-4 h-4"})})]})})]}),e.jsxs("div",{className:"relative",children:[m&&e.jsx("div",{className:"absolute top-2 right-2 z-10",children:e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-background/90 border rounded-full text-xs text-muted-foreground",children:[e.jsx("div",{className:"w-3 h-3 border-2 border-current border-t-transparent rounded-full animate-spin"}),"Updating..."]})}),i&&e.jsx("div",{className:"absolute inset-0 bg-background/80 flex items-center justify-center z-10",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}),"Loading..."]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx(A,{metadata:s,sort:Q,onSort:O}),e.jsx("tbody",{children:d.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:s!=null&&s.fields?Object.keys(s.fields).length:1,className:"px-4 py-8 text-center text-muted-foreground",children:i?"Loading...":"No data available"})}):d.map((l,u)=>e.jsx(M,{metadata:s,data:l,index:u},u))})]})})]}),e.jsx(L,{pagination:o,onPageChange:$,loading:i||m})]}),e.jsx(J,{isOpen:k,metadata:s,currentQuery:q,onClose:P,onApply:D})]})};K.__docgenInfo={description:"",methods:[],displayName:"DataTable",props:{data:{required:!0,tsType:{name:"Array",elements:[{name:"Record",elements:[{name:"string"},{name:"any"}],raw:"Record<string, any>"}],raw:"Array<Record<string, any>>"},description:""},pagination:{required:!0,tsType:{name:"PaginationConfig"},description:""},loading:{required:!1,tsType:{name:"boolean"},description:""},backgroundLoading:{required:!1,tsType:{name:"boolean"},description:""},title:{required:!1,tsType:{name:"string"},description:""},subtitle:{required:!1,tsType:{name:"string"},description:""},showSearch:{required:!1,tsType:{name:"boolean"},description:""},showFilters:{required:!1,tsType:{name:"boolean"},description:""},searchPlaceholder:{required:!1,tsType:{name:"string"},description:""},onQueryChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(query: ResourceQuery & { searchQuery?: string }) => void",signature:{arguments:[{type:{name:"intersection",raw:"ResourceQuery & { searchQuery?: string }",elements:[{name:"ResourceQuery"},{name:"signature",type:"object",raw:"{ searchQuery?: string }",signature:{properties:[{key:"searchQuery",value:{name:"string",required:!1}}]}}]},name:"query"}],return:{name:"void"}}},description:""},onPageChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(page: number, pageSize: number) => void",signature:{arguments:[{type:{name:"number"},name:"page"},{type:{name:"number"},name:"pageSize"}],return:{name:"void"}}},description:""},actions:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},className:{required:!1,tsType:{name:"string"},description:""},metadata:{required:!0,tsType:{name:"QueryMetadata"},description:""}}};export{K as D};
